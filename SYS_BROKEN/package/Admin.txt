import pyodbc
import hashlib

def validar_usuario(usuario, senha):
    # Criptografar a senha
    senha = hashlib.sha256(senha.encode()).hexdigest()
    # String de conexão
    conn_str = (
        r'Driver={SQL Server};'
        r'Server=SNVME\SQLEXPRESS;'
        r'Database=ProjAcoes;'
        r'Trusted_Connection=yes;'
    )

    # Conectar ao banco de dados
    conn = pyodbc.connect(conn_str)

    # Criar um cursor
    cursor = conn.cursor()

    # Consulta SQL
    query = "SELECT TipoUsuario FROM LOGIN WHERE Usuario = ? AND Senha = ?"

    # Executar a consulta
    cursor.execute(query, (usuario, senha))

    # Obter o resultado
    row = cursor.fetchone()

    # Fechar a conexão
    conn.close()

    # Retornar o tipo de usuário
    if row:
        return row.TipoUsuario
    else:
        return None
