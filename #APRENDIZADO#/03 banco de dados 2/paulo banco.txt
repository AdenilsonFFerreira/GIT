--APAGA BANCO DE DADOS Aula09
DROP DATABASE Aula09
GO

--CRIAR O BANCO DE DADOS Aula09
CREATE DATABASE Aula09
GO

--HABILITAR O CONTEXTO DO BANCO DE DADOS
USE Aula09
GO

--EXIBE O NOME DO BANCO DE DADOS QUE EXISTE NO SERVIDOR
SELECT name
FROM sys.databases
GO

--CRIA A TABELA FUNCIONARIOS
CREATE TABLE FUNCIONARIOS(
	ID		INT PRIMARY KEY,
	Nome	VARCHAR(25),
	Sexo	CHAR(1),
	Admissao	DATE,
	Salario		DECIMAL(10,2)
)
GO

--ALTERA O FORMATO DA DATA NO SQL SERVER
SET DATEFORMAT DMY
GO

--INSERE DADOS NA TABELA FUNCIONARIOS
INSERT INTO FUNCIONARIOS(
	ID,
	Nome,
	Sexo,
	Admissao,
	Salario)
VALUES (1, 'Maria da Silva', 'F', '10/01/2018', 2500.00)
GO

SELECT *
FROM FUNCIONARIOS
GO

SELECT ID, Nome
FROM FUNCIONARIOS
GO

--INSERE DADOS N TABELA DE FUNCIONARIOS
INSERT INTO FUNCIONARIOS VALUES (2, 'Pedro Pereira', 'M', '25/05/2015', 999.00)
GO

--INSERE DOIS NOVOS REGISTROS - SINTAXE 1
INSERT INTO FUNCIONARIOS VALUES (3, 'Maria Cristina', 'F', '10/09/2015', 1200.00)
INSERT INTO FUNCIONARIOS VALUES (4, 'Antonio Carlos', 'M', '15/05/2015', 990.00)


--INSERE QUATRO NOVOS REGISTROS - SINTAXE 2
INSERT INTO FUNCIONARIOS VALUES
	(5, 'Marcelo Augusto', 'M', '09/12/2017', 1900.00),
	(6, 'Pedro Silva', 'M', '15/11/2015', 1050.00),
	(7, 'Monica Silva', 'F', '12/10/2014', 3000.00),
	(8, 'Tiago Lima', 'M', '10/05/2016', 1350.00)
GO

--EXIBE ALGUMAS INFORMAÇÕES DOS FUNCIONARIO
--UTILIZANDO ALIASES PARA ALGUMAS COLUNAS
SELECT ID AS 'CóDigo do Funcionário',
		Nome,
		Sexo,
		Salario AS 'Salários'
FROM FUNCIONARIOS
GO

--EXIBE TODOS OS DADOS DA TABELA FUNCIONARIOS
SELECT * FROM FUNCIONARIOS
GO

--TENTAR INSERIR NOVOS REGISTROS CUJO A CHAVE PRIMARIA POSSUI O MESMO VALOR
--DE OUTRO REGISTRO JA CADASTRADO DENTRO DA TABELA FUNCIONARIOS
/*
INSERT INTO FUNCIONARIOS VALUES
	(8, 'Mateus Pereira', 'M', '25/03/2017', 2990.00)
GO
*/

SELECT TOP 3 
	ID,
	Nome AS 'XYZ'
GO

--EXIBE AS INFORMACOES DE TODOS OS FUNCIONARIOS CUJO
--SALARIO É MAIOR DO QUE 1000 REAIS
SELECT * FROM FUNCIONARIOS
WHERE Sexo = 'M' AND
		Salario > 1000
GO

--EXIBE OS DADOS DOS FUNCIONARIOS SEXO SEJA DIFERENTE DE 'M'
--VERSAO UTILIZANDO O OPERADOR !=
SELECT * FROM FUNCIONARIOS
WHERE Sexo != 'M'
GO

--EXIBE OS DADOS DOS FUNCIONARIOS SEXO SEJA DIFERENTE DE 'M'
--VERSAO UTILIZANDO O OPERADOR NOT
SELECT * FROM FUNCIONARIOS
WHERE NOT Sexo = 'M'
GO

--EXIBE OS DADOS DOS FUNCIONARIOS CUJO SALARIO ESTEJA ENTRE 1000 E 2000 REAIS
--UTILIZA OS OPERADORES >=, AND E <=
SELECT * FROM FUNCIONARIOS
WHERE	Salario >= 1000 AND
		Salario <= 2000
GO

--EXIBE OS DADOS DOS FUNCIONARIOS CUJO SALARIO ESTEJA ENTRE 1000 E 2000 REAIS
--UTILIZA OS OPERADORES BETWEEN
SELECT * FROM FUNCIONARIOS
WHERE	Salario BETWEEN 1000 AND 2000
GO

--VERIFICA SE EXISTE ALGUM FUNCIONARIO CUJO SALARIO SEJA MAIOR DQUE 1000 REAIS
-- E EXIBE UMA MENSAGEM PERSONALIZADA
IF EXISTS (SELECT * FROM FUNCIONARIOS WHERE Salario > 10000)
	PRINT 'Alguem ganha mais que 10.0000 reais...'
	ELSE
	PRINT 'Não licalizamos ninguem...'
GO

--SELECIONA TODOS OS FUNCIONARIOS CUJO NOME COMECE COM A LETRA M
SELECT * FROM FUNCIONARIOS
WHERE Nome LIKE 'M%'
GO

--SELECIONA TODOS OS FUNCIONARIOS CUJO NOME CONTENHA 'SILVA'
--UTILIZA A FUNCAO UPPER(), PARA CONVERTER O NOME PARA MAIUSCULA
SELECT * FROM FUNCIONARIOS
WHERE UPPER(Nome) LIKE '%SILVA%'
GO

--SELECIONA TODOS OS FUNCIONARIOS CUJO ID SEJA 1, 2 OU 5
--VERSAO UTILIZANDO OR
SELECT *FROM FUNCIONARIOS
WHERE	ID = 1 OR
		ID = 2 OR
		ID = 5
GO

--SELECIONA TODOS OS FUNCIONARIOS CUJO ID SEJA 1, 2 OU 5
--VERSAO UTILIZANDO IN
SELECT * FROM FUNCIONARIOS
WHERE ID IN (1,2,5)
GO

----------------------------------------------------------------------------

DBGATE
ferramenta gratuita
